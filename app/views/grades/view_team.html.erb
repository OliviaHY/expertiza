<%
@team_id = TeamsUser.team_id(@participant.parent_id, @participant.user_id)
# return if redirect_when_disallowed
@assignment = @participant.assignment
@questions = {} # A hash containing all the questions in all the questionnaires used in this assignment
questionnaires = @assignment.questionnaires
questionnaires.each do |questionnaire|
  round = AssignmentQuestionnaire.where(assignment_id: @assignment.id, questionnaire_id:questionnaire.id).first.used_in_round
  if(round!=nil)
    questionnaire_symbol = (questionnaire.symbol.to_s+round.to_s).to_sym
  else
    questionnaire_symbol = questionnaire.symbol
  end
  @questions[questionnaire_symbol] = questionnaire.questions
end

#@pscore has the newest versions of response for each response map, and only one for each response map (unless it is vary rubric by round)
pscore = @participant.scores(@questions)
# make_chart
@topic_id = SignedUpTeam.topic_id(@participant.assignment.id, @participant.user_id)
@stage = @participant.assignment.get_current_stage(@topic_id)
# calculate_all_penalties(@assignment.id)
@rscore = pscore[:review]
%>

<h1>Summary report for <%= @assignment.name %></h1>
<BR/>

<h1>Summary report for team <%= @team.name %></h1>
<h1>Summary report for part <%= @participant.fullname %></h1>

<h1># of reviews: <%= @reviews.length().to_s %></h1>


<h1># of answers: <%= @answers.length().to_s %></h1>


<table style="border: 1px solid black">
         <tr>          <td>Question</td>      <td>Weight</td>
  <% i = 1 %>
  <% @reviews.each do |review| %>
    <td style="border: 1px solid black"> <a href= "../grades/view_reviewer?id=<%=@participant.id%>&&reviewer_id=<%= review.id.to_s %>"><%= "Rev" + i.to_s %></a>  </td>
    
    <% i += 1 %>
  <% end %>
  </tr>

    <% @vm.listofrows.each do |item| %>
        <tr>
          <td style="border: 1px solid black;"> <%= item.questionText[0...25] %>   </td>
          <td style="border: 1px solid black;"> <%= item.weight %>   </td>
          <% for index in 0 .. item.score_row.length - 1 %>
              <td style="border: 1px solid black"><%= item.score_row[index].to_s %></td>
          <% end %>
        </tr>
    <% end %>
  </table>
</table>



